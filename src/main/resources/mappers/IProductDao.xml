<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yates.dao.IProductDao">
    <insert id="applyProduct" parameterType="product">
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into t_seckill_product(productid, producttitle, productpicture, originprice, merchantid, applydate, auditstate, starttime, endtime, secprice, productcount, stockcount, description)
        value(#{productId}, #{productTitle}, #{productPicture}, #{originPrice}, #{merchantId}, #{applyDate}, #{auditState}, #{startTime}, #{endTime}, #{secPrice}, #{productCount}, #{stockCount}, #{description})
    </insert>

    <delete id="deleteProductById" parameterType="int">
        delete from t_seckill_product where id = #{id}
    </delete>

    <update id="updateProduct" parameterType="product">
        update t_seckill_product set
        productid=#{productId}, producttitle=#{productTitle}, productpicture=#{productPicture}, originprice#{originPrice}, merchantid=#{merchantId}, applydate=#{applyDate},
        auditdate=#{auditDate}, auditstate=#{auditState}, starttime=#{startTime}, endtime=#{endTime}, secprice=#{secPrice}, productcount=#{productCount},
        stockcount=#{stockCount}, description=#{description}
    </update>

    <update id="updateProductState" parameterType="commonVo">
        update t_seckill_product set auditstate=#{productVo.auditState} where id=#{productVo.id}
    </update>

    <select id="queryProductById" parameterType="int" resultType="product">
        select * from t_seckill_product where id = #{id}
    </select>

    <sql id="commonSql">
        <if test="productVo != null">
            <if test="productVo.productId != null and product.productId != ''">
                and productVo.productId = "${productVo.productId}"
            </if>
            <if test="productVo.productTitle != null and product.productTitle != ''">
                and productVo.productTitle = "${productVo.productTitle}"
            </if>
            <if test="productVo.productPicture != null and product.productPicture != ''">
                and productVo.productPicture = "${productVo.productPicture}"
            </if>
            <if test="productVo.originPrice != null and product.originPrice != ''">
                and productVo.originPrice = "${productVo.originPrice}"
            </if>
            <if test="productVo.merchantId != null and product.merchantId != ''">
                and productVo.merchantId = "${productVo.merchantId}"
            </if>
            <if test="productVo.applyDate != null and product.applyDate != ''">
                and productVo.applyDate = "${productVo.applyDate}"
            </if>
            <if test="productVo.auditDate != null and product.auditDate != ''">
                and productVo.auditDate = "${productVo.auditDate}"
            </if>
            <if test="productVo.startTime != null and product.startTime != ''">
                and productVo.startTime = "${productVo.startTime}"
            </if>
            <if test="productVo.endTime != null and product.endTime != ''">
                and productVo.endTime = "${productVo.endTime}"
            </if>
            <if test="productVo.secPrice != null and product.secPrice != ''">
                and productVo.secPrice = "${productVo.secPrice}"
            </if>
            <if test="productVo.productCount != null and product.productCount != ''">
                and productVo.productCount = "${productVo.productCount}"
            </if>
            <if test="productVo.stockCount != null and product.stockCount != ''">
                and productVo.stockCount = "${productVo.stockCount}"
            </if>
            <if test="productVo.description != null and product.description != ''">
                and productVo.description = "${productVo.description}"
            </if>
        </if>
    </sql>

    <select id="queryProducts" parameterType="commonVo" resultType="product">
        select * from t_seckill_product
        <where>
            <include refid="commonSql"></include>
        </where>
    </select>
</mapper>